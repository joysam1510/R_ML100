Day018
================

HW (Kaggle)鐵達尼生存預測精簡版
-------------------------------

<https://www.kaggle.com/c/titanic>

Packages loading

``` r
library(purrr)
library(plyr)
library(tidyverse)
library(caret)
```

Data loading

``` r
df_train <- read.csv("data/titanic_train.csv")
df_test <- read.csv("data/titanic_test.csv")
dim(df_train)
```

    ## [1] 891  12

Setting training and testing data

``` r
train_y <- df_train$Survived
ids <- df_test$PassengerId
df_train <- df_train %>% select(-c("Survived","PassengerId"))
df_test <- df_test %>% select(-"PassengerId")
df <- rbind(df_train, df_test)
head(df)
```

    ##   Pclass                                                Name    Sex Age
    ## 1      3                             Braund, Mr. Owen Harris   male  22
    ## 2      1 Cumings, Mrs. John Bradley (Florence Briggs Thayer) female  38
    ## 3      3                              Heikkinen, Miss. Laina female  26
    ## 4      1        Futrelle, Mrs. Jacques Heath (Lily May Peel) female  35
    ## 5      3                            Allen, Mr. William Henry   male  35
    ## 6      3                                    Moran, Mr. James   male  NA
    ##   SibSp Parch           Ticket    Fare Cabin Embarked
    ## 1     1     0        A/5 21171  7.2500              S
    ## 2     1     0         PC 17599 71.2833   C85        C
    ## 3     0     0 STON/O2. 3101282  7.9250              S
    ## 4     1     0           113803 53.1000  C123        S
    ## 5     0     0           373450  8.0500              S
    ## 6     0     0           330877  8.4583              Q

秀出資料欄位的類型與數量

``` r
table(sapply(df, class))
```

    ## 
    ##  factor integer numeric 
    ##       5       3       2

確定只有 integer, numeric, factor 三種類型後, 分別將欄位名稱存於三個 vector 中

``` r
feature_type <- sapply(df, class)
int_var <- feature_type[which(feature_type == "integer")] %>% as.data.frame %>% rownames
num_var <- feature_type[which(feature_type == "numeric")] %>% as.data.frame %>% rownames
fac_var <- feature_type[which(feature_type == "factor")] %>% as.data.frame %>% rownames
list(integer_feature = int_var,
     numeric_feature = num_var,
     factor_feature = fac_var)
```

    ## $integer_feature
    ## [1] "Pclass" "SibSp"  "Parch" 
    ## 
    ## $numeric_feature
    ## [1] "Age"  "Fare"
    ## 
    ## $factor_feature
    ## [1] "Name"     "Sex"      "Ticket"   "Cabin"    "Embarked"

### 作業1

試著執行作業程式，觀察三種類型 (int / float / object) 的欄位分別進行( 平均 mean / 最大值 Max / 相異值 nunique ) 中的九次操作會有那些問題? 並試著解釋那些發生Error的程式區塊的原因?

``` r
list(Mean = df[int_var] %>% sapply(mean, na.rm = TRUE),
     Max = df[int_var] %>% sapply(max, na.rm = TRUE),
     Unique = df[int_var] %>% sapply(unique))
```

    ## $Mean
    ##    Pclass     SibSp     Parch 
    ## 2.2948816 0.4988541 0.3850267 
    ## 
    ## $Max
    ## Pclass  SibSp  Parch 
    ##      3      8      9 
    ## 
    ## $Unique
    ## $Unique$Pclass
    ## [1] 3 1 2
    ## 
    ## $Unique$SibSp
    ## [1] 1 0 3 4 2 5 8
    ## 
    ## $Unique$Parch
    ## [1] 0 1 2 5 3 4 6 9

``` r
list(Mean = df[num_var] %>% sapply(mean, na.rm = TRUE),
     Max = df[num_var] %>% sapply(max, na.rm = TRUE),
     Unique = df[num_var] %>% sapply(unique))
```

    ## $Mean
    ##      Age     Fare 
    ## 29.88114 33.29548 
    ## 
    ## $Max
    ##      Age     Fare 
    ##  80.0000 512.3292 
    ## 
    ## $Unique
    ## $Unique$Age
    ##  [1] 22.00 38.00 26.00 35.00    NA 54.00  2.00 27.00 14.00  4.00 58.00
    ## [12] 20.00 39.00 55.00 31.00 34.00 15.00 28.00  8.00 19.00 40.00 66.00
    ## [23] 42.00 21.00 18.00  3.00  7.00 49.00 29.00 65.00 28.50  5.00 11.00
    ## [34] 45.00 17.00 32.00 16.00 25.00  0.83 30.00 33.00 23.00 24.00 46.00
    ## [45] 59.00 71.00 37.00 47.00 14.50 70.50 32.50 12.00  9.00 36.50 51.00
    ## [56] 55.50 40.50 44.00  1.00 61.00 56.00 50.00 36.00 45.50 20.50 62.00
    ## [67] 41.00 52.00 63.00 23.50  0.92 43.00 60.00 10.00 64.00 13.00 48.00
    ## [78]  0.75 53.00 57.00 80.00 70.00 24.50  6.00  0.67 30.50  0.42 34.50
    ## [89] 74.00 22.50 18.50 67.00 76.00 26.50 60.50 11.50  0.33  0.17 38.50
    ## 
    ## $Unique$Fare
    ##   [1]   7.2500  71.2833   7.9250  53.1000   8.0500   8.4583  51.8625
    ##   [8]  21.0750  11.1333  30.0708  16.7000  26.5500  31.2750   7.8542
    ##  [15]  16.0000  29.1250  13.0000  18.0000   7.2250  26.0000   8.0292
    ##  [22]  35.5000  31.3875 263.0000   7.8792   7.8958  27.7208 146.5208
    ##  [29]   7.7500  10.5000  82.1708  52.0000   7.2292  11.2417   9.4750
    ##  [36]  21.0000  41.5792  15.5000  21.6792  17.8000  39.6875   7.8000
    ##  [43]  76.7292  61.9792  27.7500  46.9000  80.0000  83.4750  27.9000
    ##  [50]  15.2458   8.1583   8.6625  73.5000  14.4542  56.4958   7.6500
    ##  [57]  29.0000  12.4750   9.0000   9.5000   7.7875  47.1000  15.8500
    ##  [64]  34.3750  61.1750  20.5750  34.6542  63.3583  23.0000  77.2875
    ##  [71]   8.6542   7.7750  24.1500   9.8250  14.4583 247.5208   7.1417
    ##  [78]  22.3583   6.9750   7.0500  14.5000  15.0458  26.2833   9.2167
    ##  [85]  79.2000   6.7500  11.5000  36.7500   7.7958  12.5250  66.6000
    ##  [92]   7.3125  61.3792   7.7333  69.5500  16.1000  15.7500  20.5250
    ##  [99]  55.0000  25.9250  33.5000  30.6958  25.4667  28.7125   0.0000
    ## [106]  15.0500  39.0000  22.0250  50.0000   8.4042   6.4958  10.4625
    ## [113]  18.7875  31.0000 113.2750  27.0000  76.2917  90.0000   9.3500
    ## [120]  13.5000   7.5500  26.2500  12.2750   7.1250  52.5542  20.2125
    ## [127]  86.5000 512.3292  79.6500 153.4625 135.6333  19.5000  29.7000
    ## [134]  77.9583  20.2500  78.8500  91.0792  12.8750   8.8500 151.5500
    ## [141]  30.5000  23.2500  12.3500 110.8833 108.9000  24.0000  56.9292
    ## [148]  83.1583 262.3750  14.0000 164.8667 134.5000   6.2375  57.9792
    ## [155]  28.5000 133.6500  15.9000   9.2250  35.0000  75.2500  69.3000
    ## [162]  55.4417 211.5000   4.0125 227.5250  15.7417   7.7292  12.0000
    ## [169] 120.0000  12.6500  18.7500   6.8583  32.5000   7.8750  14.4000
    ## [176]  55.9000   8.1125  81.8583  19.2583  19.9667  89.1042  38.5000
    ## [183]   7.7250  13.7917   9.8375   7.0458   7.5208  12.2875   9.5875
    ## [190]  49.5042  78.2667  15.1000   7.6292  22.5250  26.2875  59.4000
    ## [197]   7.4958  34.0208  93.5000 221.7792 106.4250  49.5000  71.0000
    ## [204]  13.8625   7.8292  39.6000  17.4000  51.4792  26.3875  30.0000
    ## [211]  40.1250   8.7125  15.0000  33.0000  42.4000  15.5500  65.0000
    ## [218]  32.3208   7.0542   8.4333  25.5875   9.8417   8.1375  10.1708
    ## [225] 211.3375  57.0000  13.4167   7.7417   9.4833   7.7375   8.3625
    ## [232]  23.4500  25.9292   8.6833   8.5167   7.8875  37.0042   6.4500
    ## [239]   6.9500   8.3000   6.4375  39.4000  14.1083  13.8583  50.4958
    ## [246]   5.0000   9.8458  10.5167   7.0000   9.6875  82.2667   3.1708
    ## [253]  31.6833  31.5000  57.7500   7.8500  60.0000  15.0333  15.5792
    ## [260]  28.5375  25.7000  10.7083  13.9000   7.8208   7.7792  31.6792
    ## [267]   7.2833  75.2417       NA  12.1833  13.7750   8.9625  25.7417
    ## [274]  42.5000  27.4458 136.7792   9.3250  12.7375  45.5000   7.5750
    ## [281]   7.5792   7.7208

``` r
list(Mean = df[fac_var] %>% sapply(mean, na.rm = TRUE),
     Max = df[fac_var] %>% sapply(max, na.rm = TRUE),
     Unique = df[fac_var] %>% sapply(unique))
```

### 作業2

思考一下，試著舉出今天五種類型以外的一種或多種資料類型，你舉出的新類型是否可以歸在三大類中的某些大類? 所以三大類特徵中，哪一大類處理起來應該最複雜?
